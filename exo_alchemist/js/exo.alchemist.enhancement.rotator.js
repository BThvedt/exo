"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}!function(r,s){var i=function(){function i(t,e){var n=this;_classCallCheck(this,i),this.id="",this.speed=5e3,this.lock=!1,this.$wrapper=e,this.id=t,this.$items=e.find(".ee--rotator-item"),1<this.$items.length?(this.$itemsWrapper=e.find(".ee--rotator-items"),this.$nav=this.$wrapper.find(".ee--rotator-nav"),this.$prev=this.$wrapper.find(".ee--rotator-prev"),this.$next=this.$wrapper.find(".ee--rotator-next"),this.$navItems=this.$nav.find(".ee--rotator-nav-item"),this.$current=this.$items.first(),this.$itemsWrapper.css({position:"relative"}),this.$items.each(function(t,e){r(e).data("ee--rotator-index",t).trigger("exoAlchemistRotatorHide")}).hide(),this.$current.show(),setTimeout(function(){n.$current.trigger("exoAlchemistRotatorShow")}),this.setTimeout(),this.$wrapper.on("keydown",function(t){switch(t.which){case 39:t.preventDefault(),t.stopPropagation(),n.next();break;case 37:t.preventDefault(),t.stopPropagation(),n.prev()}}).on("swiperight",function(t){t.preventDefault(),t.stopPropagation(),n.next()}).on("swipeleft",function(t){t.preventDefault(),t.stopPropagation(),n.prev()}),this.$prev.on("click",function(t){n.prev()}).on("keydown",function(t){switch(t.which){case 13:case 32:t.preventDefault(),t.stopPropagation(),n.prev()}}),this.$next.on("click",function(t){n.next()}).on("keydown",function(t){switch(t.which){case 13:case 32:t.preventDefault(),t.stopPropagation(),n.next()}}),this.$nav.length&&1<this.$navItems.length&&(this.$navItems.first().addClass("active"),this.$navItems.each(function(t,e){r(e).data("ee--rotator-index",t)}).on("click",function(t){n.goto(r(t.target).data("ee--rotator-index"))}).on("keydown",function(t){switch(t.which){case 13:case 32:t.preventDefault(),t.stopPropagation(),n.goto(r(t.target).data("ee--rotator-index"))}})),this.isLayoutBuilder()?this.buildForLayoutBuilder():this.$wrapper.data("ee--rotator-pauseonhover")&&this.$wrapper.on("mouseover",function(t){n.pause()}).on("mouseleave",function(t){n.play()})):this.$items.first().trigger("exoAlchemistRotatorShow")}function t(){return e.apply(this,arguments)}var e;return _createClass(i,[{key:"setTimeout",value:(e=function(){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.cycle()},this.$wrapper.data("ee--rotator-speed")||this.speed)},t.toString=function(){return e.toString()},t)},{key:"buildForLayoutBuilder",value:function(){var i=this;this.$prev.length&&this.$prev.on("click",function(t){i.pause()}),this.$next.length&&this.$next.on("click",function(t){i.pause()}),this.$navItems.length&&this.$navItems.on("click",function(t){i.pause()}),r(document).on("exoComponentOps.exo.alchemist.enhancement.rotator."+this.id,function(t,e){s.ExoAlchemistAdmin.getActiveComponent().find(i.$wrapper).length&&((e=r(e)).find(".exo-field-op-rotator-prev").off("click").on("click",function(t){t.preventDefault(),i.prev()}),e.find(".exo-field-op-rotator-next").off("click").on("click",function(t){t.preventDefault(),i.next()}))}),r(document).on("exoComponentActive.exo.alchemist.enhancement.rotator."+this.id,function(t,e){r(e).find(i.$wrapper).length&&(i.$prev.length||i.$next.length||i.$navItems.length)&&i.pause()}),r(document).on("exoComponentInactive.exo.alchemist.enhancement.rotator."+this.id,function(t,e){r(e).find(i.$wrapper).length&&i.play()}),r(document).on("exoComponentFieldEditActive.exo.alchemist.enhancement.rotator."+this.id,function(t,e){var n,e=r(e);i.$wrapper.find(e).length&&(i.pause(),(n=i.$items.filter(e)).length?n.length||(n=e.find(".ee--rotator-item")):n=e.closest(".ee--rotator-item"),n.length&&n.data("ee--rotator-index")!==i.$current.data("ee--rotator-index")&&(i.cycle(n,0),s.ExoAlchemistAdmin.sizeFieldOverlay(e),s.ExoAlchemistAdmin.sizeTarget(e)))}),r(document).on("exoComponentFieldEditInactive.exo.alchemist.enhancement.rotator."+this.id,function(t,e){e=r(e);!i.$wrapper.find(e).length||i.$prev.length||i.$next.length||i.$navItems.length||i.play()})}},{key:"pause",value:function(){clearTimeout(this.timeout)}},{key:"play",value:function(){this.setTimeout()}},{key:"prev",value:function(){this.cycle(this.getPrev())}},{key:"next",value:function(){this.cycle()}},{key:"goto",value:function(n){var i=this;this.$items.each(function(t,e){t===n&&i.cycle(r(e))})}},{key:"getNext",value:function(){var t=this.$current.next();return t=0!==t.length&&t.hasClass("ee--rotator-item")?t:this.$items.first()}},{key:"getPrev",value:function(){var t=this.$current.prev();return t=0!==t.length&&t.hasClass("ee--rotator-item")?t:this.$items.last()}},{key:"cycle",value:function(t,e){var n=this,i=(this.setTimeout(),this.$current.data("ee--rotator-index")),o=(e=void 0!==e?e:1e3,this.$current),a=(o.css({zIndex:2,position:"relative"}),(t=t||this.getNext()).data("ee--rotator-index"));!0!==this.lock&&a!==i&&(this.lock=!0,t.css({zIndex:1,position:"absolute",top:0,left:0,right:0}),this.$itemsWrapper.height(o.outerHeight()),this.$navItems.length&&(this.$navItems.removeClass("active"),r(this.$navItems.get(a)).addClass("active")),setTimeout(function(){t.show().trigger("exoAlchemistRotatorShow"),s.Exo.checkElementPosition(),n.$itemsWrapper.height(t.outerHeight()),o.css("z-index",2),setTimeout(function(){o.fadeOut(e,"swing",function(){o.trigger("exoAlchemistRotatorHide"),n.$itemsWrapper.height(""),t.css({position:"relative"}),n.lock=!1})}),n.$current=t}))}},{key:"unload",value:function(){r(document).off("exoComponentOps.exo.alchemist.enhancement.rotator."+this.id),r(document).off("exoComponentActive.exo.alchemist.enhancement.rotator."+this.id),r(document).off("exoComponentInactive.exo.alchemist.enhancement.rotator."+this.id),r(document).off("exoComponentFieldEditActive.exo.alchemist.enhancement.rotator."+this.id),r(document).off("exoComponentFieldEditInactive.exo.alchemist.enhancement.rotator."+this.id)}},{key:"isLayoutBuilder",value:function(){return s.ExoAlchemistAdmin&&s.ExoAlchemistAdmin.isLayoutBuilder()}}]),i}();s.behaviors.exoAlchemistEnhancementRotator={count:0,instances:{},attach:function(t){var n=this;r(".ee--rotator-wrapper").once("exo.alchemist.enhancement").each(function(){var t=r(this),e=t.data("ee--rotator-id");n.instances[e+n.count]=new i(e,t),t.data("ee--rotator-count",n.count),n.count++})},detach:function(t,e,n){var i;"unload"===n&&(i=this,r(".ee--rotator-wrapper",t).each(function(){var t=r(this),t=t.data("ee--rotator-id")+t.data("ee--rotator-count");void 0!==i.instances[t]&&(i.instances[t].unload(),delete i.instances[t])}))}}}(jQuery,Drupal);