"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}!function(r,c){var s=function(){function n(e,t){var o=this;_classCallCheck(this,n),this.id="",this.idSelector="",this.history=!1,this.$wrapper=t,this.id=e,this.idSelector='data-ee--tabs-id="'+this.id+'"',this.$triggers=t.find(".ee--tabs-trigger["+this.idSelector+"]"),this.$contents=t.find(".ee--tabs-content["+this.idSelector+"]"),this.history=void 0!==t.data("ee--accordion-history"),this.$contents.hide();var i=this.$triggers.first();if(c.Exo.$window.on("popstate.exo.alchemist.enhancement.tabs."+this.id,function(e){var t=c.ExoAlchemistEnhancement.getHashForKey("ee--tabs");if(t&&void 0!==t[o.id]){var i=o.$triggers.filter('[data-ee--tab-id="'+t[o.id]+'"]');i.length&&o.show(i.first(),!1)}else o.show(o.$triggers.first(),!1)}),this.isLayoutBuilder())c.ExoAlchemistAdmin.lockNestedFields(this.$triggers),c.Exo.$document.on("exoComponentFieldEditActive.exo.alchemist.enhancement.tabs",function(e,t){var i=r(t),s=i.closest(".ee--tabs-content");if(s.length){var a=s.data("ee--tab-id"),n=o.$triggers.filter('[data-ee--tab-id="'+a+'"]');o.show(n,o.history),c.ExoAlchemistAdmin.sizeFieldOverlay(i),c.ExoAlchemistAdmin.sizeTarget(i)}});else{var s=c.ExoAlchemistEnhancement.getHashForKey("ee--tabs");if(s&&void 0!==s[this.id]){var a=this.$triggers.filter('[data-ee--tab-id="'+s[this.id]+'"]');a.length&&(i=a.first())}}this.show(i,!1),this.$triggers.on("click.exo.alchemist.enhancement.tabs",function(e){e.preventDefault(),o.show(r(e.currentTarget),o.history)}).on("keydown.exo.alchemist.enhancement.accordion",function(e){var t;switch(e.which){case 13:case 32:e.preventDefault(),e.stopPropagation(),o.show(r(e.currentTarget),o.history);break;case 40:e.preventDefault(),e.stopPropagation(),(t=r(e.currentTarget).next()).length&&(o.show(t,o.history),t.focus());break;case 38:e.preventDefault(),e.stopPropagation(),(t=r(e.currentTarget).prev()).length&&(o.show(t,o.history),t.focus())}})}return _createClass(n,[{key:"show",value:function(e,t){var i=e.data("ee--tab-id");if(t=!1!==t,!e.hasClass("active")){this.$triggers.removeClass("active"),e.addClass("active"),this.$contents.removeClass("active").hide();var s=this.$contents.filter('[data-ee--tab-id="'+i+'"]');s.addClass("active").show(),c.Exo.$window.trigger("ee--tab.open",{trigger:e,content:s}),c.Exo.checkElementPosition(),this.isLayoutBuilder()?(c.ExoAlchemistAdmin.lockNestedFields(this.$triggers),c.ExoAlchemistAdmin.unlockNestedFields(e)):t&&c.ExoAlchemistEnhancement.setHashForKey("ee--tabs",i,this.id)}}},{key:"buildTabHash",value:function(e){return"ee--tab-"+this.id+"--"+e}},{key:"extractTabIdFromHash",value:function(e){return e.replace("ee--tab-","").split("--")[1]}},{key:"unload",value:function(){c.Exo.$document.off("exoComponentFieldEditActive.exo.alchemist.enhancement.tabs."+this.id),c.Exo.$window.off("popstate.exo.alchemist.enhancement.tabs."+this.id)}},{key:"isLayoutBuilder",value:function(){return c.ExoAlchemistAdmin&&c.ExoAlchemistAdmin.isLayoutBuilder()}}]),n}();c.behaviors.exoAlchemistEnhancementTabs={count:0,instances:{},attach:function(e){var i=this;r(".ee--tabs-wrapper",e).once("exo.alchemist.enhancement").each(function(){var e=r(this),t=e.data("ee--tabs-id");e.data("ee--tabs-count",i.count),i.instances[t+i.count]=new s(t,e),i.count++})},detach:function(e,t,i){if("unload"===i){var s=this;r(".ee--tabs-wrapper",e).each(function(){var e=r(this),t=e.data("ee--tabs-id")+e.data("ee--tabs-count");void 0!==s.instances[t]&&(s.instances[t].unload(),delete s.instances[t])})}}}}(jQuery,Drupal);