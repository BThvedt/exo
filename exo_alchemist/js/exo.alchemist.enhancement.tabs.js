"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(a,n){var s=function(){function i(e,t){var s=this,e=(_classCallCheck(this,i),this.id="",this.idSelector="",this.history=!1,this.$wrapper=t,this.id=e,this.idSelector='data-ee--tabs-id="'+this.id+'"',this.$triggers=t.find(".ee--tabs-trigger["+this.idSelector+"]"),this.$contents=t.find(".ee--tabs-content["+this.idSelector+"]"),this.history=void 0!==t.data("ee--accordion-history"),this.$contents.hide(),this.$triggers.first());n.Exo.$window.on("popstate.exo.alchemist.enhancement.tabs."+this.id,function(e){var t=n.ExoAlchemistEnhancement.getHashForKey("ee--tabs");t&&void 0!==t[s.id]?(t=s.$triggers.filter('[data-ee--tab-id="'+t[s.id]+'"]')).length&&s.show(t.first(),!1):s.show(s.$triggers.first(),!1)}),this.isLayoutBuilder()?(n.ExoAlchemistAdmin.lockNestedFields(this.$triggers),n.Exo.$document.on("exoComponentFieldEditActive.exo.alchemist.enhancement.tabs",function(e,t){var t=a(t),i=t.closest(".ee--tabs-content");i.length&&(i=i.data("ee--tab-id"),i=s.$triggers.filter('[data-ee--tab-id="'+i+'"]'),s.show(i,s.history),n.ExoAlchemistAdmin.sizeFieldOverlay(t),n.ExoAlchemistAdmin.sizeTarget(t))})):(t=n.ExoAlchemistEnhancement.getHashForKey("ee--tabs"))&&void 0!==t[this.id]&&(t=this.$triggers.filter('[data-ee--tab-id="'+t[this.id]+'"]')).length&&(e=t.first()),this.show(e,!1),this.$triggers.on("click.exo.alchemist.enhancement.tabs",function(e){e.preventDefault(),s.show(a(e.currentTarget),s.history)}).on("keydown.exo.alchemist.enhancement.accordion",function(e){var t;switch(e.which){case 13:case 32:e.preventDefault(),e.stopPropagation(),s.show(a(e.currentTarget),s.history);break;case 40:e.preventDefault(),e.stopPropagation(),(t=a(e.currentTarget).next()).length&&(s.show(t,s.history),t.focus());break;case 38:e.preventDefault(),e.stopPropagation(),(t=a(e.currentTarget).prev()).length&&(s.show(t,s.history),t.focus())}})}return _createClass(i,[{key:"show",value:function(e,t){var i,s=e.data("ee--tab-id");t=!1!==t,e.hasClass("active")||(this.$triggers.removeClass("active"),e.addClass("active"),this.$contents.removeClass("active").hide(),(i=this.$contents.filter('[data-ee--tab-id="'+s+'"]')).addClass("active").show(),n.Exo.$window.trigger("ee--tab.open",{trigger:e,content:i}),n.Exo.checkElementPosition(),this.isLayoutBuilder()?(n.ExoAlchemistAdmin.lockNestedFields(this.$triggers),n.ExoAlchemistAdmin.unlockNestedFields(e)):t&&n.ExoAlchemistEnhancement.setHashForKey("ee--tabs",s,this.id))}},{key:"buildTabHash",value:function(e){return"ee--tab-"+this.id+"--"+e}},{key:"extractTabIdFromHash",value:function(e){return e.replace("ee--tab-","").split("--")[1]}},{key:"unload",value:function(){n.Exo.$document.off("exoComponentFieldEditActive.exo.alchemist.enhancement.tabs."+this.id),n.Exo.$window.off("popstate.exo.alchemist.enhancement.tabs."+this.id)}},{key:"isLayoutBuilder",value:function(){return n.ExoAlchemistAdmin&&n.ExoAlchemistAdmin.isLayoutBuilder()}}]),i}();n.behaviors.exoAlchemistEnhancementTabs={count:0,instances:{},attach:function(e){var i=this;a(".ee--tabs-wrapper",e).once("exo.alchemist.enhancement").each(function(){var e=a(this),t=e.data("ee--tabs-id");e.data("ee--tabs-count",i.count),i.instances[t+i.count]=new s(t,e),i.count++})},detach:function(e,t,i){var s;"unload"===i&&(s=this,a(".ee--tabs-wrapper",e).each(function(){var e=a(this),e=e.data("ee--tabs-id")+e.data("ee--tabs-count");void 0!==s.instances[e]&&(s.instances[e].unload(),delete s.instances[e])}))}}}(jQuery,Drupal);