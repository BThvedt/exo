"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,i){for(var t=0;t<i.length;t++){var o=i[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,i,t){return i&&_defineProperties(e.prototype,i),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(a,l){var o=function(){function n(e,i){var t,c=this,e=(_classCallCheck(this,n),this.id="",this.idSelector="",this.speed=5e3,this.history=!1,this.require=!1,this.$wrapper=i,this.id=e,this.idSelector='data-ee--accordion-id="'+this.id+'"',this.$items=i.find(".ee--accordion-item["+this.idSelector+"]"),this.$triggers=i.find(".ee--accordion-trigger["+this.idSelector+"]"),this.$contents=i.find(".ee--accordion-content["+this.idSelector+"]"),this.history=void 0!==i.data("ee--accordion-history"),this.require=void 0!==i.data("ee--accordion-require"),void 0!==i.data("ee--accordion-collapse")),o=(this.$contents.hide(),this.$triggers.first()),i=!1;this.$items.each(function(e,i){var t,o,i=a(i),n=i.find(".ee--accordion-trigger"),i=i.find(".ee--accordion-content");n.data("ee--accordion-item-id")||(t=c.id+"-trigger-"+e,o=c.id+"-content-"+e,n.attr("id",t).attr("data-ee--accordion-item-id",e).attr("aria-controls",o),i.attr("id",o).attr("aria-labelledby",t))}),l.Exo.$window.on("popstate.exo.alchemist.enhancement.tabs."+this.id,function(e){var i=l.ExoAlchemistEnhancement.getHashForKey("ee--accordion");i&&void 0!==i[c.id]?(i=c.$triggers.filter('[data-ee--accordion-item-id="'+i[c.id]+'"]')).length&&c.show(i.first(),!0,!0,!1):c.show(c.$triggers.first(),!0,!0,!1)}),this.isLayoutBuilder()?(l.ExoAlchemistAdmin.lockNestedFields(this.$items),l.Exo.$document.on("exoComponentFieldEditActive.exo.alchemist.enhancement.accordion."+this.id,function(e,i){i=a(i);i.hasClass("ee--accordion-item")&&c.$wrapper.find(i).length&&(c.show(i,!1,!1,c.history),l.ExoAlchemistAdmin.sizeFieldOverlay(i),l.ExoAlchemistAdmin.sizeTarget(i))})):(t=l.ExoAlchemistEnhancement.getHashForKey("ee--accordion"))&&void 0!==t[c.id]&&(t=c.$triggers.filter('[data-ee--accordion-item-id="'+t[c.id]+'"]')).length&&(o=t.first(),i=!0),this.$triggers.on("click.exo.alchemist.enhancement.accordion",function(e){e.preventDefault(),c.show(a(e.currentTarget),!0,c.keepOpen(),c.history)}).on("keydown.exo.alchemist.enhancement.accordion",function(e){var i;switch(e.which){case 13:case 32:e.preventDefault(),e.stopPropagation(),c.show(a(e.currentTarget),!0,c.keepOpen(),c.history);break;case 40:e.preventDefault(),e.stopPropagation(),(i=a(e.currentTarget).closest(".ee--accordion-item["+c.idSelector+"]").next().find(".ee--accordion-trigger["+c.idSelector+"]")).length&&(c.show(i,!0,c.keepOpen(),c.history),i.focus());break;case 38:e.preventDefault(),e.stopPropagation(),(i=a(e.currentTarget).closest(".ee--accordion-item["+c.idSelector+"]").prev().find(".ee--accordion-trigger["+c.idSelector+"]")).length&&(c.show(i,!0,c.keepOpen(),c.history),i.focus())}}),!1!=e&&!i||(l.Exo.$window.on("ee--tab.open."+this.id,function(e,i){i.content.find(c.$wrapper).length&&c.show(o,!0,!0,!1)}),this.show(o,!1,!0,!1))}return _createClass(n,[{key:"keepOpen",value:function(){return this.require||this.isLayoutBuilder()}},{key:"show",value:function(e,i,t,o){var n=this,c=(i=void 0===i||i,t=void 0!==t&&t,o=void 0===o||o,e.closest(".ee--accordion-item["+this.idSelector+"]")),a=c.find(".ee--accordion-content["+this.idSelector+"]"),r=e.data("ee--accordion-item-id");if(a.length){var s=c.hasClass("show"),d=this.$items.filter(".show"),h=d.find(".ee--accordion-content["+this.idSelector+"]");if(this.isLayoutBuilder()){if(s)return;l.ExoAlchemistAdmin.lockNestedFields(d)}(!s||t)&&s||(d.removeClass("show"),e.attr("aria-expanded","false"),o&&void 0!==r&&l.ExoAlchemistEnhancement.removeHashForKey("ee--accordion",r,this.id),i?h.slideToggle(350,"swing"):h.hide()),s&&!t||!o||void 0===r||l.ExoAlchemistEnhancement.setHashForKey("ee--accordion",r,this.id),s||(c.addClass("show"),this.$wrapper.attr("data-ee--accordion-show",r),e.attr("aria-expanded","true"),i?a.slideToggle(350,"swing",function(){l.Exo.checkElementPosition(),n.isLayoutBuilder()&&l.ExoAlchemistAdmin.unlockNestedFields(c)}):(a.show(),l.Exo.checkElementPosition(),this.isLayoutBuilder()&&l.ExoAlchemistAdmin.unlockNestedFields(c)))}}},{key:"unload",value:function(){l.Exo.$document.off("exoComponentFieldEditActive.exo.alchemist.enhancement.accordion."+this.id),l.Exo.$window.off("popstate.exo.alchemist.enhancement.accordion."+this.id),l.Exo.$window.off("ee--tab.open."+this.id)}},{key:"isLayoutBuilder",value:function(){return l.ExoAlchemistAdmin&&l.ExoAlchemistAdmin.isLayoutBuilder()}}]),n}();l.behaviors.exoAlchemistEnhancementAccordion={count:0,instances:{},attach:function(e){var t=this;a(".ee--accordion-wrapper",e).once("exo.alchemist.enhancement").each(function(){var e=a(this),i=e.data("ee--accordion-id");e.data("ee--accordion-count",t.count),t.instances[i+t.count]=new o(i,e),t.count++})},detach:function(e,i,t){var o;"unload"===t&&(o=this,a(".ee--accordion-wrapper",e).each(function(){var e=a(this),e=e.data("ee--accordion-id")+e.data("ee--accordion-count");void 0!==o.instances[e]&&(o.instances[e].unload(),delete o.instances[e])}))}}}(jQuery,Drupal,drupalSettings);