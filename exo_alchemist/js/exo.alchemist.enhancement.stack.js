"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0===i)return("string"===t?String:Number)(e);i=i.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(f,e,p){(g=void 0===g?function(){}:g).osHasReducedMotion=function(){var e;return!!window.matchMedia&&!!(e=window.matchMedia("(prefers-reduced-motion: reduce)"))&&e.matches};var g,n=_createClass(function e(t,i){_classCallCheck(this,e),this.id="",this.$wrapper=i,this.$items=i.find(".ee--stack-item");function n(e){var t;this.element=e,this.items=this.element.getElementsByClassName("ee--stack-item"),this.scrollingFn=!1,this.scrolling=!1,s(e=this),new IntersectionObserver(function(e){e[0].isIntersecting?this.scrollingFn||function(e){e.scrollingFn=function(){this.scrolling||(this.scrolling=!0,window.requestAnimationFrame(o.bind(this)))}.bind(e),window.addEventListener("scroll",e.scrollingFn)}(this):this.scrollingFn&&(window.removeEventListener("scroll",this.scrollingFn),this.scrollingFn=!1)}.bind(e),{threshold:[0,1]}).observe(e.element),(t=this).element.addEventListener("resize-stack-cards",function(){s(t),o.bind(t),window.scrollTo(window.scrollX,window.scrollY-1),window.scrollTo(window.scrollX,window.scrollY+1)})}var r=[];this.id=t;function s(e){e.marginY=getComputedStyle(e.element).getPropertyValue("--stack-cards-gap"),i=e,(t=document.createElement("div")).setAttribute("style","opacity:0; visbility: hidden;position: absolute; height:"+i.marginY),i.element.appendChild(t),i.marginY=parseInt(getComputedStyle(t).getPropertyValue("height")),i.element.removeChild(t),e.elementHeight=e.element.offsetHeight;var t,i=getComputedStyle(e.items[0]);e.cardTop=Math.floor(parseFloat(i.getPropertyValue("top"))),e.cardHeight=Math.floor(parseFloat(i.getPropertyValue("height"))),e.windowHeight=window.innerHeight,isNaN(e.marginY)?e.element.style.paddingBottom="0px":e.element.style.paddingBottom=e.marginY*(e.items.length-1)+"px";for(var n=0;n<e.items.length;n++){var r=p.offsets.top+e.marginY,s=f(".exo-fixed-header");s.length&&(r+=s.outerHeight()),e.items[n].style.top=r+"px",isNaN(e.marginY)?e.items[n].style.transform="none;":e.items[n].style.transform="translateY("+e.marginY*n+"px)"}}function o(){if(!isNaN(this.marginY)){var e=this.element.getBoundingClientRect().top;if(!(0<this.cardTop-e+this.element.windowHeight-this.elementHeight-this.cardHeight+this.marginY+this.marginY*this.items.length))for(var t=0;t<this.items.length;t++){var i=this.cardTop-e-t*(this.cardHeight+this.marginY);0<i?(i=t===this.items.length-1?1:(this.cardHeight-.05*i)/this.cardHeight,this.items[t].style.transform="translateY("+this.marginY*t+"px) scale("+i+")",this.items.length!==t+1&&this.items[t].classList.add("ee--stack-item-back")):(this.items[t].style.transform="translateY("+this.marginY*t+"px)",this.items[t].classList.remove("ee--stack-item-back"))}}this.scrolling=!1}var a,l="IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype,c=g.osHasReducedMotion();if(0<i.length&&l&&!c){for(var h=function(){for(var e=0;e<r.length;e++)r[e].element.dispatchEvent(u)},m=0;m<i.length;m++)a=m,r.push(new n(i[a]));var d=null,u=new CustomEvent("resize-stack-cards");f(document).on("drupalViewportOffsetChange."+t,function(){h()}),window.addEventListener("resize",function(){clearTimeout(d),d=setTimeout(h,500)})}});e.behaviors.exoAlchemistEnhancementStack={count:0,instances:{},attach:function(e){var i=this;f(".ee--stack-wrapper",e).once("exo.alchemist.enhancement").each(function(){var e=f(this),t=e.data("ee--stack-id");e.data("ee--stack-count",i.count),i.instances[t+i.count]=new n(t,e),i.count++})},detach:function(e,t,i){var n;"unload"===i&&(n=this,f(".ee--stack-wrapper",e).each(function(){var e=f(this),e=e.data("ee--stack-id")+e.data("ee--stack-count");void 0!==n.instances[e]&&(n.instances[e].unload(),delete n.instances[e])}))}}}(jQuery,Drupal,Drupal.displace);