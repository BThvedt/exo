!function(a,t,e){"use strict";var o;t.behaviors.linkit_autocomplete={attach:function(t){t=a(t).find("input.form-linkit-autocomplete").once("linkit-autocomplete");t.length&&(a.widget("ui.autocomplete",a.ui.autocomplete,{_create:function(){this._super(),this.widget().menu("option","items","> :not(.linkit-result-line--group)")},_renderMenu:o.options.renderMenu,_renderItem:o.options.renderItem}),t.autocomplete(o.options),t.click(function(){var t=a(this);t.autocomplete("search",t.val())}),t.each(function(){var i=a(this);i.autocomplete("widget").addClass("linkit-ui-autocomplete"),i.closest(".form-item").siblings(".form-type-textfield").find(".linkit-widget-title").each(function(){var t=a(this),e=i.val();e&&e===t.val()&&t.addClass("link-widget-title--auto")}).change(function(){a(this).removeClass("link-widget-title--auto")})}),t.on("compositionstart.autocomplete",function(){o.options.isComposing=!0}),t.on("compositionend.autocomplete",function(){o.options.isComposing=!1}))},detach:function(t,e,i){"unload"===i&&a(t).find("input.form-linkit-autocomplete").removeOnce("linkit-autocomplete").autocomplete("destroy")}},o={cache:{},options:{source:function(t,e){var i=this.element.attr("id"),n=(i in o.cache||(o.cache[i]={}),t.term);o.cache[i].hasOwnProperty(n)?e(o.cache[i][n]):(t=a.extend({success:function(t){o.cache[i][n]=t.suggestions,e(t.suggestions)},data:{q:n}},o.ajax),a.ajax(this.element.attr("data-autocomplete-path"),t))},focus:function(){return!1},search:function(t){return!o.options.isComposing},select:function(t,e){var i=a(t.target).closest("form,fieldset,tr");if(!e.item.path)throw"Missing path param."+JSON.stringify(e.item);if(a('input[name="href_dirty_check"]',i).val(e.item.path),!(e.item.entity_type_id||e.item.entity_uuid||e.item.substitution_id)||e.item.entity_type_id&&e.item.entity_uuid&&e.item.substitution_id)return a('input[name="attributes[href]"], input[name$="[attributes][href]"]',i).val(e.item.path),a('input[name="attributes[data-entity-type]"], input[name$="[attributes][data-entity-type]"]',i).val(e.item.entity_type_id),a('input[name="attributes[data-entity-uuid]"], input[name$="[attributes][data-entity-uuid]"]',i).val(e.item.entity_uuid),a('input[name="attributes[data-entity-substitution]"], input[name$="[attributes][data-entity-substitution]"]',i).val(e.item.substitution_id),e.item.label&&0<(i=a("*[data-linkit-widget-title-autofill-enabled]",i)).length&&(i.val()&&!i.hasClass("link-widget-title--auto")||(i.val(e.item.label),i.addClass("link-widget-title--auto"))),t.target.value=e.item.path,!1;throw"Missing path param."+JSON.stringify(e.item)},renderItem:function(t,e){var i=a("<li>").addClass("linkit-result-line"),n=a("<div>").addClass("linkit-result-line-wrapper");return n.append(a("<span>").html(e.label).addClass("linkit-result-line--title")),e.hasOwnProperty("description")&&n.append(a("<span>").html(e.description).addClass("linkit-result-line--description")),i.append(n).appendTo(t)},renderMenu:function(i,t){var n=this.element.autocomplete("instance"),t=e.groupBy(t,function(t){return t.hasOwnProperty("group")?t.group:""});a.each(t,function(t,e){t.length&&i.append('<li class="linkit-result-line--group ui-menu-divider">'+t+"</li>"),a.each(e,function(t,e){n._renderItemData(i,e)})})},minLength:1,isComposing:!1},ajax:{dataType:"json"}}}(jQuery,Drupal,_);